<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Script dependencies · Nervos CKB</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Deploy a VM and run code on the VM"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Script dependencies · Nervos CKB"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.nervos.org/"/><meta property="og:description" content="## Deploy a VM and run code on the VM"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-139882771-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-139882771-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/nervos-logo.svg" alt="Nervos CKB"/><h2 class="headerTitleWithLogo">Nervos CKB</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://explorer.nervos.org" target="_blank">Explorer</a></li><li class=""><a href="https://github.com/nervosnetwork" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Technical Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/introduction/welcome">Welcome</a></li><li class="navListItem"><a class="navItem" href="/introduction/nervos-intro">What is Nervos?</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Key Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/key-concepts/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/nervos-blockchain">Nervos Blockchain</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/cell-model">Cell Model</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/consensus">Consensus</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/economics">Economics</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/ckb-vm">CKB-VM</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Technical Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/technical-concepts/architecture">CKB Architecture</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/design-philosophy">Design Philosophy</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/state-tokens">State and Tokens</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/technical-concepts/script-dependencies">Script dependencies</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/transaction-validation-lifecycle">Transaction Validation Lifecycle</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/ckb-vm-verification-rules">CKB VM Verification Rules</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tooling<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/tooling/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/tooling/neuron">Neuron Wallet</a></li><li class="navListItem"><a class="navItem" href="/tooling/ckb-explorer">CKB-Explorer</a></li><li class="navListItem"><a class="navItem" href="/tooling/ckb-sdk-js">ckb-sdk-js</a></li><li class="navListItem"><a class="navItem" href="/tooling/ckb-sdk-ruby">ckb-sdk-ruby</a></li><li class="navListItem"><a class="navItem" href="/tooling/community">Community Contribution</a></li><li class="navListItem"><a class="navItem" href="/tooling/useful-materials">Useful Materials</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/getting-started/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/getting-started/run-node">Run a CKB Mainnet Node</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Development Guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/dev-guide/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/testnet">Testnet Aggron</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/devchain">Dev Chain</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/ckb-cli">ckb-cli</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/ckb-sdk">ckb-sdk</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/faucet">Testnet Faucet</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/api">CKB JSON-RPC Protocols</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/debugging-ckb-script">Debugging CKB script</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Glossary<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/glossary/glossary-general">General Glossary</a></li><li class="navListItem"><a class="navItem" href="/glossary/glossary-economic">Economic Glossary</a></li><li class="navListItem"><a class="navItem" href="/glossary/glossary-technical">Technical Glossary</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">References<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/references/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/references/mining-resources">Mining Resources</a></li><li class="navListItem"><a class="navItem" href="/references/nervos-design">Nervos System Design</a></li><li class="navListItem"><a class="navItem" href="/references/neuron-wallet-guide">Neuron Wallet Guide</a></li><li class="navListItem"><a class="navItem" href="/references/neuron-faq">Neuron FAQ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/nervosnetwork/docs/edit/master/docs/technical-concepts/script-dependencies.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Script dependencies</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="deploy-a-vm-and-run-code-on-the-vm"></a><a href="#deploy-a-vm-and-run-code-on-the-vm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deploy a VM and run code on the VM</h2>
<p>Since we are working with a virtualized mini computer in CKB VM, there’s nothing stopping us from embedding another VM as a CKB script that runs on CKB VM. In this article we will explore this VM on top of VM path.</p>
<p>Through this method, we can have JavaScript on CKB via duktape, Ruby on CKB via mruby, we can even have Bitcoin Script or EVM on chain by just compiling those VMs and storing them as scripts on CKB. This compatibility ensures CKB VM can both help to preserve legacy code and build a diversified ecosystem.</p>
<p>All languages are treated equal on CKB, giving freedom to blockchain contract developers to build on top of CKB however they feel is best.</p>
<p>To use duktape on CKB, first you need to compile the duktape VM itself into a RISC-V executable binary:</p>
<pre><code class="hljs">$ git clone https://github.com/xxuejie/ckb-duktape
$ cd ckb-duktape
$ git submodule init
$ git submodule <span class="hljs-keyword">update</span>
$ sudo docker run <span class="hljs-comment">--rm -it -v `pwd`:/code nervos/ckb-riscv-gnu-toolchain:xenial bash</span>
root@<span class="hljs-number">0</span>d31cad7a539:~<span class="hljs-comment"># cd /code</span>
root@<span class="hljs-number">0</span>d31cad7a539:/code<span class="hljs-comment"># make</span>
riscv64-<span class="hljs-literal">unknown</span>-elf-gcc -Os -DCKB_NO_MMU -D__riscv_soft_float -D__riscv_float_abi_soft -Iduktape -Ic -Wall -Werror c/entry.c -c -o <span class="hljs-keyword">build</span>/entry.o
riscv64-<span class="hljs-literal">unknown</span>-elf-gcc -Os -DCKB_NO_MMU -D__riscv_soft_float -D__riscv_float_abi_soft -Iduktape -Ic -Wall -Werror duktape/duktape.c -c -o <span class="hljs-keyword">build</span>/duktape.o
riscv64-<span class="hljs-literal">unknown</span>-elf-gcc <span class="hljs-keyword">build</span>/entry.o <span class="hljs-keyword">build</span>/duktape.o -o <span class="hljs-keyword">build</span>/duktape -lm -Wl,-<span class="hljs-keyword">static</span> -fdata-sections -ffunction-sections -Wl,<span class="hljs-comment">--gc-sections -Wl,-s</span>
root@<span class="hljs-number">0</span>d31cad7a539:/code<span class="hljs-comment"># exit</span>
<span class="hljs-keyword">exit</span>
$ ls <span class="hljs-keyword">build</span>/duktape
<span class="hljs-keyword">build</span>/duktape*
</code></pre>
<p>Here we use the ruby SDK to interact with CKB, please refer to the official <a href="https://github.com/nervosnetwork/ckb-sdk-ruby/blob/develop/README.md">README</a> for how to set it up. Then deploy the duktape script code in a CKB cell:</p>
<pre><code class="hljs">pry(main)&gt; duktape_data = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">File</span>.</span></span>read(<span class="hljs-string">"../ckb-duktape/build/duktape"</span>)
pry(main)&gt; duktape_data.bytesize
=&gt; <span class="hljs-number">269064</span>
pry(main)&gt; duktape_tx_hash = wallet.send<span class="hljs-constructor">_capacity(<span class="hljs-params">wallet</span>.<span class="hljs-params">address</span>, CKB::Utils.<span class="hljs-params">byte_to_shannon</span>(280000)</span>, CKB::<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Utils</span>.</span></span>bin<span class="hljs-constructor">_to_hex(<span class="hljs-params">duktape_data</span>)</span>)
pry(main)&gt; duktape_data_hash = CKB::<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Blake2b</span>.</span></span>hexdigest(duktape_data)
pry(main)&gt; duktape_cell_dep = CKB::Types::<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">CellDep</span>.</span></span><span class="hljs-keyword">new</span>(out_point: CKB::Types::<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">OutPoint</span>.</span></span><span class="hljs-keyword">new</span>(tx_hash: duktape_tx_hash, index: <span class="hljs-number">0</span>))
</code></pre>
<p>The duktape script code now requires one argument: the JavaScript source you want to execute</p>
<pre><code class="hljs">pry(main)&gt; duktape_hello_type_script = <span class="hljs-string">CKB:</span>:<span class="hljs-string">Types:</span>:Script.<span class="hljs-keyword">new</span>(<span class="hljs-string">code_hash:</span> duktape_data_hash, <span class="hljs-string">args:</span> <span class="hljs-string">CKB:</span>:Utils.bin_to_hex(<span class="hljs-string">"CKB.debug(\"I'm running in JS!\")"</span>))
</code></pre>
<p>Notice that with a different argument, you can create a different duktape powered type script for a different use case:</p>
<pre><code class="hljs">pry(main)&gt; duktape_hello_type_script = <span class="hljs-string">CKB:</span>:<span class="hljs-string">Types:</span>:Script.<span class="hljs-keyword">new</span>(<span class="hljs-string">code_hash:</span> duktape_data_hash, <span class="hljs-string">args:</span> <span class="hljs-string">CKB:</span>:Utils.bin_to_hex(<span class="hljs-string">"var a = 1;\nvar b = a + 2;"</span>))
</code></pre>
<p>This demonstrates the differences mentioned above on script code vs script: here duktape serves as script code providing a JavaScript engine, while a different script leveraging the duktape script code serves a different function on chain.</p>
<p>Now we can create a cell with the duktape type script attached:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-title">pry</span><span class="hljs-params">(main)</span></span>&gt; tx = wallet.generate_tx(wallet2<span class="hljs-selector-class">.address</span>, CKB::Utils.byte_to_shannon(<span class="hljs-number">200</span>))
<span class="hljs-function"><span class="hljs-title">pry</span><span class="hljs-params">(main)</span></span>&gt; tx<span class="hljs-selector-class">.cell_deps</span>.push(duktape_out_point.dup)
<span class="hljs-function"><span class="hljs-title">pry</span><span class="hljs-params">(main)</span></span>&gt; tx<span class="hljs-selector-class">.outputs</span><span class="hljs-selector-class">.type</span> = duktape_hello_type_script<span class="hljs-selector-class">.dup</span>
<span class="hljs-function"><span class="hljs-title">pry</span><span class="hljs-params">(main)</span></span>&gt; tx<span class="hljs-selector-class">.witnesses</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">"0x"</span>
<span class="hljs-function"><span class="hljs-title">pry</span><span class="hljs-params">(main)</span></span>&gt; tx = tx.sign(wallet<span class="hljs-selector-class">.key</span>, api.compute_transaction_hash(tx))
<span class="hljs-function"><span class="hljs-title">pry</span><span class="hljs-params">(main)</span></span>&gt; api.send_transaction(tx)
=&gt; <span class="hljs-string">"0x2e4d3aab4284bc52fc6f07df66e7c8fc0e236916b8a8b8417abb2a2c60824028"</span>
</code></pre>
<p>We can see that the script executes successfully and if you have the ckb-script module’s log level set to debug in your ckb.toml file, you will also notice the following log:</p>
<pre><code class="hljs">2019-07-15 05:59:13.551 +00:00 http.worker8 <span class="hljs-builtin-name">DEBUG</span> ckb-script <span class="hljs-built_in"> script </span>group: c35b9fed5fc0dd6eaef5a918cd7a4e4b77ea93398bece4d4572b67a474874641 <span class="hljs-builtin-name">DEBUG</span> OUTPUT: I<span class="hljs-string">'m running in JS!
</span></code></pre>
<p>Now you have successfully deployed a JavaScript engine on CKB, and have also run JavaScript-based script on CKB! Feel free to try any JavaScript code you want here.</p>
<h2><a class="anchor" aria-hidden="true" id="dynamic-linking"></a><a href="#dynamic-linking" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dynamic linking</h2>
<p>There are two dynamic linking functions implemented in <a href="https://github.com/nervosnetwork/ckb-c-stdlib/blob/693c58163fe37d6abd326c537447260a846375f0/ckb_dlfcn.h#L94">nervosnetwork/ckb-c-stdlib</a>, which are <code>ckb_dlopen()</code> and <code>ckb_dlsym()</code>.</p>
<p><code>ckb_dlopen()</code> loads the dynamic library from a cell by its data hash and returns an opaque &quot;handle&quot; for the dynamic library. <code>ckb_dlsym()</code> takes a &quot;handle&quot; of a dynamic library returned by <code>ckb_dlopen()</code> and the symbol name, and returns the address where that symbol is loaded into memory.</p>
<p><a href="https://github.com/nervosnetwork/ckb-miscellaneous-scripts/blob/5b06297d4451ee1fb496fb48625481b26386de78/c/or.c#L86-L98">nervosnetwork/ckb-miscellaneous-scripts</a> has a simple example for using these two functions.</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">ckb_dlopen</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *dep_cell_data_hash, <span class="hljs-keyword">uint8_t</span> *aligned_addr,
               <span class="hljs-keyword">size_t</span> aligned_size, <span class="hljs-keyword">void</span> **handle, <span class="hljs-keyword">size_t</span> *consumed_size)</span></span>;

<span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">ckb_dlsym</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *handle, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *symbol)</span></span>;
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="how-dependencies-work"></a><a href="#how-dependencies-work" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How dependencies work</h2>
<p>There are two different dependency fields in the transaction data structure: <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0022-transaction-structure/0022-transaction-structure.md#code-locating"><code>cell_deps</code></a> and <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0022-transaction-structure/0022-transaction-structure.md#header-deps"><code>header_deps</code></a>.</p>
<p><code>cell_deps</code> allow scripts in the transaction to access (read-only) referenced live cells.</p>
<p><code>header_deps</code> allow scripts in the transaction to access (read-only) data of referenced past block headers of the blockchain.</p>
<p>Please refer to the <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0022-transaction-structure/0022-transaction-structure.md">CKB Transaction Structure RFC</a> for more details.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 4/24/2020</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/technical-concepts/state-tokens"><span class="arrow-prev">← </span><span>State and Tokens</span></a><a class="docs-next button" href="/technical-concepts/transaction-validation-lifecycle"><span>Transaction Validation Lifecycle</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#deploy-a-vm-and-run-code-on-the-vm">Deploy a VM and run code on the VM</a></li><li><a href="#dynamic-linking">Dynamic linking</a></li><li><a href="#how-dependencies-work">How dependencies work</a></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'ef49666369943baa0a93aedc37511318',
                indexName: 'nervos-ckb',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>