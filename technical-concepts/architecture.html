<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>CKB Architecture · Nervos CKB</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="![data-structure](/assets/ckb-structure.png)"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="CKB Architecture · Nervos CKB"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.nervos.org/"/><meta property="og:description" content="![data-structure](/assets/ckb-structure.png)"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-139882771-1"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'UA-139882771-1');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/nervos-logo.svg" alt="Nervos CKB"/><h2 class="headerTitleWithLogo">Nervos CKB</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://explorer.nervos.org" target="_blank">Explorer</a></li><li class=""><a href="https://github.com/nervosnetwork" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Technical Concepts</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/introduction/welcome">Welcome</a></li><li class="navListItem"><a class="navItem" href="/introduction/nervos-intro">What is Nervos?</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Key Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/key-concepts/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/nervos-blockchain">Nervos Blockchain</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/cell-model">Cell Model</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/consensus">Consensus</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/economics">Economics</a></li><li class="navListItem"><a class="navItem" href="/key-concepts/ckb-vm">CKB-VM</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Technical Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/technical-concepts/architecture">CKB Architecture</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/design-philosophy">Design Philosophy</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/state-tokens">State and Tokens</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/script-dependencies">Script dependencies</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/transaction-validation-lifecycle">Transaction Validation Lifecycle</a></li><li class="navListItem"><a class="navItem" href="/technical-concepts/ckb-vm-verification-rules">CKB VM Verification Rules</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tooling<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/tooling/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/tooling/neuron">Neuron Wallet</a></li><li class="navListItem"><a class="navItem" href="/tooling/ckb-explorer">CKB-Explorer</a></li><li class="navListItem"><a class="navItem" href="/tooling/ckb-sdk-js">ckb-sdk-js</a></li><li class="navListItem"><a class="navItem" href="/tooling/ckb-sdk-ruby">ckb-sdk-ruby</a></li><li class="navListItem"><a class="navItem" href="/tooling/community">Community Contribution</a></li><li class="navListItem"><a class="navItem" href="/tooling/useful-materials">Useful Materials</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/getting-started/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/getting-started/run-node">Run a CKB Mainnet Node</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Development Guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/dev-guide/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/testnet">Testnet Aggron</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/devchain">Dev Chain</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/ckb-cli">ckb-cli</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/ckb-sdk">ckb-sdk</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/faucet">Testnet Faucet</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/api">CKB JSON-RPC Protocols</a></li><li class="navListItem"><a class="navItem" href="/dev-guide/debugging-ckb-script">Debugging CKB script</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Glossary<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/glossary/glossary-general">General Glossary</a></li><li class="navListItem"><a class="navItem" href="/glossary/glossary-economic">Economic Glossary</a></li><li class="navListItem"><a class="navItem" href="/glossary/glossary-technical">Technical Glossary</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">References<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/references/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/references/mining-resources">Mining Resources</a></li><li class="navListItem"><a class="navItem" href="/references/nervos-design">Nervos System Design</a></li><li class="navListItem"><a class="navItem" href="/references/neuron-wallet-guide">Neuron Wallet Guide</a></li><li class="navListItem"><a class="navItem" href="/references/neuron-faq">Neuron FAQ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/nervosnetwork/docs/edit/master/docs/technical-concepts/architecture.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">CKB Architecture</h1></header><article><div><span><p><img src="/assets/ckb-structure.png" alt="data-structure"></p>
<p>There are primarily four major data structures in CKB: cell, transaction, script, and block.</p>
<p>You can find detailed descriptions of these data structures in <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0019-data-structures/0019-data-structures.md">RFC#0019</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="cell"></a><a href="#cell" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cell</h2>
<blockquote>
<p>More information about the cell can be found in the <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0002-ckb/0002-ckb.md#42-cell">Nervos CKB RFC</a>.</p>
</blockquote>
<p>A cell is the most basic element in CKB system. Cell can be used to store state or scripts.</p>
<p>A state cell may contain the state data of an application or a UDT (User Defined Token), for example, a user's balance of a particular UDT.</p>
<p>A script cell may contain the logic of an application or the rules of a UDT, such as a rule preventing negative UDT balances.</p>
<blockquote>
<p>It is feasible that a cell could store both the state and the logic of an application, however, if this application will leverage the power of <a href="https://github.com/Awesome-Layer-2/Awesome-Layer-2">Layer 2 solutions</a>, this is not recommended. This may result in the problem described in <a href="https://medium.com/@kelvinfichter/looking-at-ownership-in-the-evm-6e6914d341d">&quot;Looking at ownership in the EVM&quot;</a>.</p>
</blockquote>
<p>A cell contains four fields:</p>
<ul>
<li><code>capacity</code> limits the size of the cell.</li>
<li><code>data</code> stores the state or script data.</li>
<li><code>type</code> defines the type of cell by defining the conditions under which the <code>data</code> field can be modified.</li>
<li><code>lock</code> defines the ownership of a cell.</li>
</ul>
<p>We will explain how these four fields work in the next section.</p>
<h2><a class="anchor" aria-hidden="true" id="transaction"></a><a href="#transaction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction</h2>
<blockquote>
<p>More information about the transactions in Nervos CKB can be found in the <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0002-ckb/0002-ckb.md#44-transaction">Nervos CKB RFC</a>, as well as <a href="https://medium.com/nervosnetwork/exploring-an-essential-data-structure-in-ckb-the-transaction-a1ca8fcbfbda">this article describing transaction structure</a>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="structure"></a><a href="#structure" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Structure</h3>
<p>Transaction is for updating the cells on-chain (i.e. the state on-chain). By sending a transaction to a CKB node, the transaction will be verified and confirmed by all nodes and the new cells containing new state will become valid on-chain.</p>
<p>Each transaction has a group of input cells (old state) and a group of output cells (new state). This is different from transactions in Ethereum, in which transactions only contain an event to kick off updating state on-chain. After receiving a transaction, an Ethereum node will calculate a new state based on the transaction data and prior on-chain state, then replace the old state with the newly calculated state. While Ethereum generates new state on-chain, Nervos CKB requires state to be generated off-chain and then subsequently verified on-chain.</p>
<p>A transaction contains three parts: a group of input cells (<code>inputs</code>),  a group of output cells (<code>outputs</code>), dependent library code (<code>deps</code>) and signature(s)  (<code>witness</code>) to support transaction processing.</p>
<h3><a class="anchor" aria-hidden="true" id="transaction-verification"></a><a href="#transaction-verification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Transaction Verification</h3>
<blockquote>
<p><a href="https://github.com/nervosnetwork/rfcs/pull/80">Here is an RFC</a> that lists all the transaction verification rules defined by CKB protocol.</p>
</blockquote>
<p>After a CKB node receives a transaction, it will first verify that the transaction conforms to CKB protocol rules, examples of protocol rules:</p>
<ol>
<li><p>Only live cells can be used as inputs to a transaction. A cell is either 1) live (unspent) or 2) dead (spent).  After a transaction is mined and confirmed on-chain, its input cells become &quot;dead&quot;, and the output cells become &quot;live&quot;. This mechanism prevents double spending.</p></li>
<li><p>Sum capacity of the output cells must be lower than or equal to the input cells.</p></li>
</ol>
<blockquote>
<p>The sum capacity difference between the input and output cells are collected as mining fees paid to the block miner. It is also possible to pay mining fees with UDTs as long as a miner is willing to accept them.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="scripts"></a><a href="#scripts" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scripts</h2>
<p>Apart from the rules defined by the CKB protocol, a transaction will also need to be verified according to the <code>lock</code> scripts of the transaction input cells and the <code>type</code> scripts of transaction input and output cells.  Understanding the operation of<code>lock</code> and  <code>type</code> scripts is essential to understanding state transitions and UDT or application logic on Nervos CKB.</p>
<h3><a class="anchor" aria-hidden="true" id="lock-script"></a><a href="#lock-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>lock</code> script</h3>
<p>As mentioned above, the <code>lock</code> script defines the ownership of a cell.</p>
<p>In a transaction, each of the <code>inputs</code> has two values: an input cell and an array of <code>args</code>.</p>
<blockquote>
<p>Input cell is technically a pointer to a previous transaction's output cell. This is why the input cells are sometimes named <code>previous_output</code>.</p>
</blockquote>
<p>In the transaction, there is also a field named <code>witnesses</code>, which is an array of arbitrary arguments to fulfill lock and type scripts' requirements to make the transaction a valid one. Witnesses are user inputs of the state transition represented by the transaction.</p>
<p>A typical <code>lock</code> script may contain the information of the public key of the cell owner. To unlock a cell, a user usually needs to include a signature in the <code>witnesses</code> field. During the verification process, the <code>lock</code> script will recover the signature and check if it matches the stored public key, ensuring the transaction is indeed signed by the owner of the input cells.</p>
<blockquote>
<p>The signature function and the hash function used by <code>lock</code> script (or <code>type</code> script) is not defined by CKB protocol. Developers are free to design and implement their own signature functions in the <code>lock</code> script.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="type-script"></a><a href="#type-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>type</code> script</h3>
<p>A <code>type</code> script defines the conditions under which a cell can be transformed, or in other words, constraints on state transition. In a transaction, when a group of input cells and a group of output cells have the same <code>type</code> field value, the transformation from the input cells to the output cells must comply with rules defined by the <code>type</code> script.</p>
<p>For example, Alice owns a cell, with a <code>data</code> field that stores her balance of a particular UDT, its <code>type</code> script defines the rules and logic of this UDT. If Alice wants to send some of her tokens to Bob, then she would use this cell as input, and create an output cell with same <code>type</code> field value, but use Bob's <code>lock</code> script for this output cell. Alice can then assemble the transaction and send it to a CKB node. (Alice also needs to create another output cell for herself if she is not sending the entire token balance in this cell to Bob)</p>
<h3><a class="anchor" aria-hidden="true" id="script-verification"></a><a href="#script-verification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Script Verification</h3>
<p>After receiving a transaction, the CKB node will verify the <code>lock</code> script with the <code>args</code> of this input cell, as well as the <code>witness</code>, to make sure that Alice indeed owns the cell. It will then verify the <code>type</code> script of input cells and output cells in groups (inputs and outputs will the same <code>type</code> script) to make sure that the UDT transaction is valid according to the rules defined by the <code>type</code> script.</p>
<blockquote>
<p>In practice, script code is NOT included in the <code>type</code> or <code>lock</code> script directly. The actual code would be stored in another cell, referenced by the <code>type</code> and <code>lock</code> scripts through their hash. This is done by referring to these cells in the dependency cells field (<code>deps</code>) in the transaction using their <code>outpoint</code>, and placing the hash of their <code>data</code> fields in the <code>code_hash</code> field of <code>type</code> or <code>lock</code>.</p>
</blockquote>
<p>During the verification process, the specified scripts are loaded and executed in a CKB-VM instance. If the instance returns a code 0 upon the end of execution, the scripts execution is succeeded. Check the <a href="https://github.com/nervosnetwork/rfcs/tree/master/rfcs/0003-ckb-vm">CKB-VM RFC</a> to learn more about how it works in the CKB-VM.</p>
<p>To learn more about how to write <code>script</code> in practice, please refer <a href="../dev-guide/scripts">write script section</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="block"></a><a href="#block" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Block</h2>
<p>A block structure contains a group of transactions and a block header including metadata. It is the miner's job to pack transactions into a block and do the Proof-of-Work calculation to find a &quot;seal&quot; to seal the block, then broadcast it to the network. Other miners will receive this block, verify it, collect some transactions from their own transaction pool and start to mine a new block based on this received block.</p>
<p>In CKB, a block also contains the information of uncle blocks in the block structure. It has the complete uncle block header as well as their proposals. Please refer to <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0019-data-structures/0019-data-structures.md#uncleblock">RFC#0019-Data Structures</a> for more details.</p>
<h3><a class="anchor" aria-hidden="true" id="computing-cycles-and-transaction-size"></a><a href="#computing-cycles-and-transaction-size" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Computing 'Cycles' and Transaction Size</h3>
<p>There are two limitations miners consider when selecting transactions to pack into a block: computing cycles and transaction size.</p>
<p>In CKB, the computational resources consumed by transaction verification, (specifically script execution), is measured with <code>cycles</code>. Each instruction in CKB-VM carries a <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0014-vm-cycle-limits/0014-vm-cycle-limits.md#instruction-cycles">different cycle cost</a>. The sum cycles consumed by all scripts executed when verifying all the transactions in a block is limited by the  <code>MAX_BLOCK_CYCLES</code> value defined by the CKB protocol.</p>
<p>The size of a transaction is measured in bytes. The sum size of all the transactions in a block should be lower than <code>MAX_BLOCK_BYTES</code> as defined by the CKB protocol.</p>
<blockquote>
<p>On mainnet Lina, the value of <code>MAX_BLOCK_BYTES</code> is <code>597_000</code> and <code>MAX_BLOCK_CYCLES</code> is <code>3_500_000_000</code>.</p>
</blockquote>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 1/5/2020</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/key-concepts/ckb-vm"><span class="arrow-prev">← </span><span>CKB-VM</span></a><a class="docs-next button" href="/technical-concepts/design-philosophy"><span>Design Philosophy</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#cell">Cell</a></li><li><a href="#transaction">Transaction</a><ul class="toc-headings"><li><a href="#structure">Structure</a></li><li><a href="#transaction-verification">Transaction Verification</a></li></ul></li><li><a href="#scripts">Scripts</a><ul class="toc-headings"><li><a href="#lock-script"><code>lock</code> script</a></li><li><a href="#type-script"><code>type</code> script</a></li><li><a href="#script-verification">Script Verification</a></li></ul></li><li><a href="#block">Block</a><ul class="toc-headings"><li><a href="#computing-cycles-and-transaction-size">Computing 'Cycles' and Transaction Size</a></li></ul></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'ef49666369943baa0a93aedc37511318',
                indexName: 'nervos-ckb',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>